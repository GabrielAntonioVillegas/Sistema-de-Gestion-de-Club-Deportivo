import java.sql.SQLException;
import javax.swing.JOptionPane;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.List;
import javax.swing.JOptionPane;
//--------------------------------Insertar
private void inserta(String nombre, String cargoSeleccionado,String dni){
        Connection con = null;
        PreparedStatement pstUsuario = null;
        ResultSet rsUsuario = null;
        String nombre2 = null;
        try {
            con = DatabaseConnection.getConnection(); // Asegúrate de que este método maneje excepciones
        // Verificar si el DNI ya existe
        String queryDNI = "SELECT COUNT(*) FROM Empleado WHERE dni = ?";
        pstUsuario = con.prepareStatement(queryDNI);
        pstUsuario.setString(1, dni);
        rsUsuario = pstUsuario.executeQuery();

        if (rsUsuario.next() && rsUsuario.getInt(1) > 0) {
            JOptionPane.showMessageDialog(null, "El DNI ya está registrado.", "Error", JOptionPane.ERROR_MESSAGE);
            return; // Salir del método si el DNI ya existe
        }
        // Verificar si el usuario está registrado
        String queryUsuario = "SELECT idcargo FROM Cargo WHERE cargos = ?";
        pstUsuario = con.prepareStatement(queryUsuario);
         pstUsuario.setString(1, cargoSeleccionado); 
        rsUsuario = pstUsuario.executeQuery();

        // Procesar los resultados
        while (rsUsuario.next()) {
            // Aquí puedes obtener los datos que necesites
            nombre2 = rsUsuario.getString("idcargo"); // Cambia "nombre_columna" al nombre real
            System.out.println(nombre2);
            
 
            // Hacer algo con los datos, por ejemplo, agregar a un JComboBox
            // cargos_ele.addItem(nombre);
        }
    } catch (Exception e) {
        e.printStackTrace(); // Manejo de errores
    } finally {
        // Cerrar conexiones
        try {
            if (rsUsuario != null) rsUsuario.close();
            if (pstUsuario != null) pstUsuario.close();
            if (con != null) con.close();
        } catch (Exception e) {
            e.printStackTrace(); // Manejo de errores al cerrar
        }
    }
        
     PreparedStatement pstInsert = null;

        try {
            // Establecer la conexión
            con = DatabaseConnection.getConnection();

            // Crear la consulta
            String queryInsert = "INSERT INTO Empleado (nombre,idcargo,dni) VALUES (?,?,?)";
            pstInsert = con.prepareStatement(queryInsert);

            // Establecer los parámetros
            pstInsert.setString(1,nombre); // Asignar el nombre
            pstInsert.setString(2, nombre2); // Asignar el id del cargo
            pstInsert.setString(3, dni);
              // Ejecutar la consulta
            int filasInsertadas = pstInsert.executeUpdate();
            System.out.println("Filas insertadas: " + filasInsertadas);
            
            Notificacion_alta newframe = new Notificacion_alta();
       
            newframe.setVisible(true);
       
            this.dispose();
        } catch (Exception e) {
            e.printStackTrace(); // Manejo de errores
        } finally {
            // Cerrar conexiones
            try {
                if (pstInsert != null) pstInsert.close();
                if (con != null) con.close();
            } catch (Exception e) {
                e.printStackTrace(); // Manejo de errores al cerrar
            }
        }
    }
//----------------------------------------------Consulta--------------------------------------------
private List<String> consulta() {
    Connection con = null;
    PreparedStatement pstUsuario = null;
    ResultSet rsUsuario = null;
    List<String> listaCargos = new ArrayList<>();
    try {
        con = DatabaseConnection.getConnection(); // Asegúrate de que este método maneje excepciones
       
        // Verificar si el usuario está registrado
        String queryUsuario = "SELECT * FROM Cargo";
        pstUsuario = con.prepareStatement(queryUsuario);
        rsUsuario = pstUsuario.executeQuery();

        // Procesar los resultados
        while (rsUsuario.next()) {
            // Aquí puedes obtener los datos que necesites
            String nombre = rsUsuario.getString("cargos"); // Cambia "nombre_columna" al nombre real
            System.out.println(nombre);
            
            listaCargos.add(nombre);
            // Hacer algo con los datos, por ejemplo, agregar a un JComboBox
            // cargos_ele.addItem(nombre);
        }
    } catch (Exception e) {
        e.printStackTrace(); // Manejo de errores
    } finally {
        // Cerrar conexiones
        try {
            if (rsUsuario != null) rsUsuario.close();
            if (pstUsuario != null) pstUsuario.close();
            if (con != null) con.close();
        } catch (Exception e) {
            e.printStackTrace(); // Manejo de errores al cerrar
        }
    }
      
        return listaCargos;
    }
